{"name":"Nomysql","tagline":"This is a sample Spring Project to show how to use HSQLDB and JavaConfig. This example also will show how to use @PropertySource for reading properties and using the Environment Object to add properties to your objects. This Project is using Java, Spring, Hibernate, Maven, jUnit, Log4J, HSQLDB and Github. ","body":"### NoMySQL\r\n\r\nThe days of using MySQL, DB2, PostgreSQL etc for development is over.. I don't know why any programmer would be developing using them..\r\n\r\nEvery deveroper should be running some in memory database like HSQLDB as part of the project for development and testing then move the a full size database for unit testing, staging and production.\r\n\r\nThis is a sample Spring Project to show how to use JavaConfig and HSQLDB. This example also will show how to use @PropertySource for reading properties and using the Environment Object to add properties to your objects.\r\n\r\n### How to use Spring JavaConfig and not XML files for configuation\r\n\r\nConsider replacing Spring XML configuration with JavaConfig\r\n\r\nUsing Spring XML configuration is so 2000â€™s the time has come to push the XML away and look at JavaConfig.\r\n\r\nHere is the main code to my sample project\r\n\r\n\tpublic class Main\r\n    {\r\n\r\n        private static final Logger LOGGER = getLogger(Main.class);\r\n\r\n        public static void main(String[] args)\r\n        {\r\n            // in this setup, both the main(String[]) method and the JUnit method both specify that\r\n            ApplicationContext context = new AnnotationConfigApplicationContext( DatabaseConfiguration.class );\r\n\r\n            MessageService mService = context.getBean(MessageService.class);\r\n\r\n            /**\r\n             *   Saving Message to database\r\n             */\r\n            Message message = new Message();\r\n            message.setMessage(\"Hello World\");\r\n            mService.SaveMessage(message);\r\n\r\n\r\n            /**\r\n             * Saving 2nd Message in database.\r\n             */\r\n            message.setMessage(\"I love NYC\");\r\n            mService.SaveMessage(message);\r\n\r\n            /**\r\n             * Getting messages from database\r\n             *    - display number of message(s)\r\n             *    - display each message in database\r\n             */\r\n            List<Message> myList = mService.listMessages();\r\n            LOGGER.debug(\"You Have \" + myList.size() + \" Message(s) In The Database\");\r\n\r\n            for (Message i : myList)\r\n            {\r\n                LOGGER.debug(\"Message: ID: \" + i.getId() + \", Message: \" + i.getMessage() + \".\");\r\n            }\r\n        }\r\n    }\r\n \r\n\r\nNow lets take a look at how I setup the database in JavaConfig and not in a XML file.\r\n\r\n    @Configuration\r\n    @EnableTransactionManagement\r\n    @ComponentScan(basePackageClasses = {Main.class})\r\n    @PropertySource(\"classpath:application.properties\")\r\n    public class DatabaseConfiguration\r\n    {\r\n\r\n\r\n    @Bean\r\n    public DataSourceInitializer dataSourceInitializer(DataSource dataSource) {\r\n        ResourceDatabasePopulator resourceDatabasePopulator = new ResourceDatabasePopulator();\r\n        resourceDatabasePopulator.addScript(new ClassPathResource(\"/schema.sql\"));\r\n\r\n            DataSourceInitializer dataSourceInitializer = new DataSourceInitializer();\r\n            dataSourceInitializer.setDataSource(dataSource);\r\n            dataSourceInitializer.setDatabasePopulator(resourceDatabasePopulator);\r\n            return dataSourceInitializer;\r\n        }\r\n\r\n        @Bean\r\n        public DataSource hsqlDataSource() {\r\n            BasicDataSource basicDataSource = new BasicDataSource();\r\n            basicDataSource.setDriverClassName(org.hsqldb.jdbcDriver.class.getName());\r\n            basicDataSource.setUsername(\"sa\");\r\n            basicDataSource.setPassword(\"\");\r\n            basicDataSource.setUrl(\"jdbc:hsqldb:mem:mydb\");\r\n            return basicDataSource;\r\n        }\r\n\r\n        @Bean\r\n        public LocalSessionFactoryBean sessionFactory(Environment environment,\r\n                                                  DataSource dataSource) {\r\n\r\n            String packageOfModelBeans = Message.class.getPackage().getName();\r\n            LocalSessionFactoryBean factoryBean = new LocalSessionFactoryBean();\r\n            factoryBean.setDataSource(dataSource);\r\n            factoryBean.setHibernateProperties(buildHibernateProperties(environment));\r\n            factoryBean.setPackagesToScan(packageOfModelBeans);\r\n            return factoryBean;\r\n        }\r\n\r\n        protected Properties buildHibernateProperties(Environment env) {\r\n            Properties hibernateProperties = new Properties();\r\n\r\n            hibernateProperties.setProperty(\"hibernate.dialect\", env.getProperty(\"hibernate.dialect\"));\r\n            hibernateProperties.setProperty(\"hibernate.show_sql\", env.getProperty(\"hibernate.show_sql\"));\r\n            hibernateProperties.setProperty(\"hibernate.use_sql_comments\", env.getProperty(\"hibernate.use_sql_comments\"));\r\n            hibernateProperties.setProperty(\"hibernate.format_sql\", env.getProperty(\"hibernate.format_sql\"));\r\n            hibernateProperties.setProperty(\"hibernate.hbm2ddl.auto\", env.getProperty(\"hibernate.hbm2ddl.auto\"));\r\n\r\n            hibernateProperties.setProperty(\"hibernate.generate_statistics\", env.getProperty(\"hibernate.generate_statistics\"));\r\n\r\n            hibernateProperties.setProperty(\"javax.persistence.validation.mode\", env.getProperty(\"javax.persistence.validation.mode\"));\r\n\r\n            //Audit History flags\r\n            hibernateProperties.setProperty(\"org.hibernate.envers.store_data_at_delete\", env.getProperty(\"org.hibernate.envers.store_data_at_delete\"));\r\n            hibernateProperties.setProperty(\"org.hibernate.envers.global_with_modified_flag\", env.getProperty(\"org.hibernate.envers.global_with_modified_flag\"));\r\n\r\n            return hibernateProperties;\r\n        }\r\n\r\n        @Bean\r\n        public HibernateTransactionManager hibernateTransactionManager(SessionFactory sessionFactory) {\r\n            return new HibernateTransactionManager(sessionFactory);\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n\r\nYou can see how easy it is to use JavaConfig and Not XML.. The time of using XML files with Springs is over...\r\n\r\ncheckout the project from github.\r\n\r\n    git clone git@github.com:JohnathanMarkSmith/NoMySQL.git\r\n    cd NoMySQL\r\n    mvn package\r\n    cd target\r\n    java -jar NoMySQL.jar\r\n\r\nThats it and you should see the following line on the console:\r\n\r\n    2013-04-30 10:47:17,790 [main] DEBUG com.johnathanmarksmith.noMySQL.Main - You Have 2 Message(s) In The Database\r\n    2013-04-30 10:47:17,790 [main] DEBUG com.johnathanmarksmith.noMySQL.Main - Message: ID: 1, Message: Hello World.\r\n    2013-04-30 10:47:17,790 [main] DEBUG com.johnathanmarksmith.noMySQL.Main - Message: ID: 2, Message: I love NYC.\r\n\r\nThis Project is using Java, Spring, Hibernate, Maven, jUnit, Log4J, HSQLDB and Github.\r\n\r\nIf you have any questions please email me at john@johnathanmarksmith.com","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}